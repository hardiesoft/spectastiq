<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Spectastiq Example</title>
  <style>
    body {
        margin: 0;
        background: darkgrey;
        font-family: sans-serif;
        overflow: hidden;
    }
    .link {
        text-align: left;
        display: inline-block;
        padding-top: 20px;
        padding-left: 20px;
    }
    .container {
        margin: 0 30px;
    }
  </style>
  <script src="./enable-threads.js"></script>
  <script type="module" src="./spectastiq.js" crossorigin></script>
</head>
<body>
  <div class="container">
<!--    <spectastiq-viewer id="spectastiq" src="20241016-180800.aac" start="0.3" end="0.6"></spectastiq-viewer>-->
<!--    <spectastiq-viewer id="spectastiq" src="20241016-180800.aac" start="0.6362606609808102" end="0.7739184934701493"></spectastiq-viewer>-->
<!--    <spectastiq-viewer id="spectastiq" src="20241016-180800.aac"></spectastiq-viewer>-->
<!--    recording-2055766-05-01-2025--15-01-42.mp4 -->
    <spectastiq-viewer id="spectastiq" src="robin-1.wav">
<!--      <div slot="player-controls">-->
<!--        <button>Click me</button>-->
<!--      </div>-->
    </spectastiq-viewer>
    <button class="src-button">
      recording-2055766-05-01-2025--15-01-42.mp4
    </button>
    <button class="src-button">
      20241107-214637.aac
    </button>
    <button class="src-button">
      robin-1.wav
    </button>
<!--    <spectastiq-viewer id="spectastiq" src="051226-kakapo-billbooming.ogg"></spectastiq-viewer>-->

<!--    <spectastiq-viewer id="spectastiq" src="/tomtits/Westland Tai Poutini National Park 6.m4a"></spectastiq-viewer>-->
<!--    <spectastiq-viewer id="spectastiq" src="robin-1.wav"></spectastiq-viewer>-->
<!--    <spectastiq-viewer id="spectastiq" src="quail114277ecut.mp3"></spectastiq-viewer>-->
<!--    <spectastiq-viewer id="spectastiq" src="chirps.wav"></spectastiq-viewer>-->
    <a class="link" href="https://github.com/hardiesoft/spectastiq">Spectastiq github repo</a>
  </div>
  <div id="timings"></div>
  <script>
    const spectastiq = document.getElementById("spectastiq");
    let tracks = [
      {
        "id": 4730203,
        "start": 0,
        "end": 3.7970125,
        "tags": [
          {
            "confidence": 100,
            "data": {
              "name": "Master"
            },
            "id": 8464249,
            "automatic": true,
            "trackId": 4730203,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 100,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464250,
            "automatic": true,
            "trackId": 4730203,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "minFreq": 6090,
        "maxFreq": 7630,
        "filtered": false,
        "positions": [
          {
            "x": 0,
            "y": 0.25375,
            "width": 0.06,
            "height": 0.06416666666666666
          }
        ]
      },
      {
        "id": 4730205,
        "start": 0.2856833333333333,
        "end": 2.383816666666667,
        "tags": [
          {
            "confidence": 85,
            "data": {
              "name": "Master"
            },
            "id": 8464252,
            "automatic": true,
            "trackId": 4730205,
            "what": "noise",
            "path": "all.noise"
          },
          {
            "confidence": 85,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464254,
            "automatic": true,
            "trackId": 4730205,
            "what": "noise",
            "path": "all.noise"
          }
        ],
        "automatic": true,
        "maxFreq": 480,
        "filtered": true,
        "positions": [
          {
            "x": 0,
            "y": 0,
            "width": 0.03,
            "height": 0.02
          }
        ]
      },
      {
        "id": 4730207,
        "start": 0.7341125000000001,
        "end": 3.3403875,
        "tags": [
          {
            "confidence": 100,
            "data": {
              "name": "Master"
            },
            "id": 8464256,
            "automatic": true,
            "trackId": 4730207,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 100,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464258,
            "automatic": true,
            "trackId": 4730207,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "minFreq": 7502,
        "maxFreq": 8888,
        "filtered": false,
        "positions": [
          {
            "x": 0.01,
            "y": 0.3125833333333333,
            "width": 0.04,
            "height": 0.05775
          }
        ]
      },
      {
        "id": 4730209,
        "start": 9.456820833333335,
        "end": 11.694283333333335,
        "tags": [
          {
            "confidence": 98,
            "data": {
              "name": "Master"
            },
            "id": 8464261,
            "automatic": true,
            "trackId": 4730209,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 98,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464262,
            "automatic": true,
            "trackId": 4730209,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "minFreq": 20522,
        "maxFreq": 20928,
        "filtered": false,
        "positions": [
          {
            "x": 0.16,
            "y": 0.8550833333333333,
            "width": 0.04,
            "height": 0.016916666666666667
          }
        ]
      },
      {
        "id": 4730210,
        "start": 11.490558333333333,
        "end": 12.523233333333334,
        "tags": [
          {
            "confidence": 44,
            "data": {
              "name": "Master",
              "raw_tag": "noise"
            },
            "id": 8464263,
            "automatic": true,
            "trackId": 4730210,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 44,
            "data": {
              "name": "badv2-april",
              "raw_tag": "noise"
            },
            "id": 8464264,
            "automatic": true,
            "trackId": 4730210,
            "what": "unidentified",
            "path": "all.other.unidentified"
          }
        ],
        "automatic": true,
        "maxFreq": 348,
        "filtered": false,
        "positions": [
          {
            "x": 0.19,
            "y": 0,
            "width": 0.02,
            "height": 0.0145
          }
        ]
      },
      {
        "id": 4730211,
        "start": 12.6625625,
        "end": 14.301729166666666,
        "tags": [
          {
            "confidence": 34,
            "data": {
              "name": "Master",
              "raw_tag": "noise"
            },
            "id": 8464265,
            "automatic": true,
            "trackId": 4730211,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 34,
            "data": {
              "name": "badv2-april",
              "raw_tag": "noise"
            },
            "id": 8464266,
            "automatic": true,
            "trackId": 4730211,
            "what": "unidentified",
            "path": "all.other.unidentified"
          }
        ],
        "automatic": true,
        "maxFreq": 180,
        "filtered": false,
        "positions": [
          {
            "x": 0.21,
            "y": 0,
            "width": 0.03,
            "height": 0.0075
          }
        ]
      },
      {
        "id": 4730212,
        "start": 17.758029166666667,
        "end": 20.28234583333333,
        "tags": [
          {
            "confidence": 95,
            "data": {
              "name": "Master"
            },
            "id": 8464267,
            "automatic": true,
            "trackId": 4730212,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 95,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464268,
            "automatic": true,
            "trackId": 4730212,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "minFreq": 5934,
        "maxFreq": 8566,
        "filtered": false,
        "positions": [
          {
            "x": 0.3,
            "y": 0.24725,
            "width": 0.04,
            "height": 0.10966666666666666
          }
        ]
      },
      {
        "id": 4730213,
        "start": 25.717354166666667,
        "end": 28.462958333333333,
        "tags": [
          {
            "confidence": 99,
            "data": {
              "name": "Master"
            },
            "id": 8464269,
            "automatic": true,
            "trackId": 4730213,
            "what": "noise",
            "path": "all.noise"
          },
          {
            "confidence": 99,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464270,
            "automatic": true,
            "trackId": 4730213,
            "what": "noise",
            "path": "all.noise"
          }
        ],
        "automatic": true,
        "maxFreq": 600,
        "filtered": true,
        "positions": [
          {
            "x": 0.43,
            "y": 0,
            "width": 0.05,
            "height": 0.025
          }
        ]
      },
      {
        "id": 4730214,
        "start": 30.403029166666666,
        "end": 31.206220833333333,
        "tags": [
          {
            "confidence": 30,
            "data": {
              "name": "Master",
              "raw_tag": "noise"
            },
            "id": 8464271,
            "automatic": true,
            "trackId": 4730214,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 30,
            "data": {
              "name": "badv2-april",
              "raw_tag": "noise"
            },
            "id": 8464272,
            "automatic": true,
            "trackId": 4730214,
            "what": "unidentified",
            "path": "all.other.unidentified"
          }
        ],
        "automatic": true,
        "maxFreq": 192,
        "filtered": false,
        "positions": [
          {
            "x": 0.51,
            "y": 0,
            "width": 0.01,
            "height": 0.008
          }
        ]
      },
      {
        "id": 4730215,
        "start": 31.119579166666668,
        "end": 35.38960833333333,
        "tags": [
          {
            "confidence": 97,
            "data": {
              "name": "Master"
            },
            "id": 8464273,
            "automatic": true,
            "trackId": 4730215,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 97,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464274,
            "automatic": true,
            "trackId": 4730215,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "minFreq": 3494,
        "maxFreq": 4446,
        "filtered": false,
        "positions": [
          {
            "x": 0.52,
            "y": 0.14558333333333334,
            "width": 0.07,
            "height": 0.03966666666666667
          }
        ]
      },
      {
        "id": 4730217,
        "start": 33.83825416666667,
        "end": 60.032,
        "tags": [
          {
            "confidence": 96,
            "data": {
              "name": "Master"
            },
            "id": 8464277,
            "automatic": true,
            "trackId": 4730217,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 96,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464278,
            "automatic": true,
            "trackId": 4730217,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "minFreq": 3422,
        "maxFreq": 5088,
        "filtered": false,
        "positions": [
          {
            "x": 0.56,
            "y": 0.14258333333333334,
            "width": 0.44,
            "height": 0.06941666666666667
          }
        ]
      },
      {
        "id": 4730216,
        "start": 34.04900416666666,
        "end": 36.4176,
        "tags": [
          {
            "confidence": 84,
            "data": {
              "name": "Master"
            },
            "id": 8464275,
            "automatic": true,
            "trackId": 4730216,
            "what": "noise",
            "path": "all.noise"
          },
          {
            "confidence": 84,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464276,
            "automatic": true,
            "trackId": 4730216,
            "what": "noise",
            "path": "all.noise"
          }
        ],
        "automatic": true,
        "maxFreq": 528,
        "filtered": true,
        "positions": [
          {
            "x": 0.57,
            "y": 0,
            "width": 0.04,
            "height": 0.022
          }
        ]
      },
      {
        "id": 4730218,
        "start": 43.7341375,
        "end": 54.773925,
        "tags": [
          {
            "confidence": 99,
            "data": {
              "name": "Master"
            },
            "id": 8464279,
            "automatic": true,
            "trackId": 4730218,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 99,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464280,
            "automatic": true,
            "trackId": 4730218,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "minFreq": 4726,
        "maxFreq": 7064,
        "filtered": false,
        "positions": [
          {
            "x": 0.73,
            "y": 0.19691666666666666,
            "width": 0.18,
            "height": 0.09741666666666667
          }
        ]
      },
      {
        "id": 4730219,
        "start": 55.08770833333333,
        "end": 56.726875,
        "tags": [
          {
            "confidence": 100,
            "data": {
              "name": "Master"
            },
            "id": 8464281,
            "automatic": true,
            "trackId": 4730219,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 100,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464282,
            "automatic": true,
            "trackId": 4730219,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 75,
            "data": {
              "name": "Master"
            },
            "id": 8464283,
            "automatic": true,
            "trackId": 4730219,
            "what": "silvereye",
            "path": "all.bird.silvereye"
          },
          {
            "confidence": 75,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464284,
            "automatic": true,
            "trackId": 4730219,
            "what": "silvereye",
            "path": "all.bird.silvereye"
          }
        ],
        "automatic": true,
        "minFreq": 7950,
        "maxFreq": 8860,
        "filtered": false,
        "positions": [
          {
            "x": 0.92,
            "y": 0.33125,
            "width": 0.03,
            "height": 0.03791666666666667
          }
        ]
      },
      {
        "id": 4730220,
        "start": 55.317191666666666,
        "end": 60.032,
        "tags": [
          {
            "confidence": 100,
            "data": {
              "name": "Master"
            },
            "id": 8464285,
            "automatic": true,
            "trackId": 4730220,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 100,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464286,
            "automatic": true,
            "trackId": 4730220,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "minFreq": 4654,
        "maxFreq": 7426,
        "filtered": false,
        "positions": [
          {
            "x": 0.92,
            "y": 0.19391666666666665,
            "width": 0.08,
            "height": 0.1155
          }
        ]
      },
      {
        "id": 4730222,
        "start": 57.61085416666667,
        "end": 60.032,
        "tags": [
          {
            "confidence": 100,
            "data": {
              "name": "Master"
            },
            "id": 8464288,
            "automatic": true,
            "trackId": 4730222,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 100,
            "data": {
              "name": "badv2-april"
            },
            "id": 8464290,
            "automatic": true,
            "trackId": 4730222,
            "what": "bird",
            "path": "all.bird"
          }
        ],
        "automatic": true,
        "maxFreq": 1092,
        "filtered": false,
        "positions": [
          {
            "x": 0.96,
            "y": 0,
            "width": 0.04,
            "height": 0.0455
          }
        ]
      }
    ];
    tracks = [
      {
        "id": 4882520,
        "start": 0,
        "end": 0.6182,
        "tags": [
          {
            "confidence": 81,
            "data": {
              "name": "Master"
            },
            "id": 8802796,
            "automatic": true,
            "trackId": 4882520,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 81,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802797,
            "automatic": true,
            "trackId": 4882520,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 92,
            "data": {
              "name": "Master"
            },
            "id": 8802798,
            "automatic": true,
            "trackId": 4882520,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 92,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802799,
            "automatic": true,
            "trackId": 4882520,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866865,
            "automatic": false,
            "trackId": 4882520,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 940,
        "maxFreq": 1290,
        "filtered": false,
        "positions": [
          {
            "x": 0,
            "y": 0.03916666666666667,
            "width": 0.01,
            "height": 0.014583333333333334
          }
        ]
      },
      {
        "id": 4882521,
        "start": 3.814575,
        "end": 4.65055,
        "tags": [
          {
            "confidence": 98,
            "data": {
              "name": "Master"
            },
            "id": 8802800,
            "automatic": true,
            "trackId": 4882521,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 98,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802801,
            "automatic": true,
            "trackId": 4882521,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 99,
            "data": {
              "name": "Master"
            },
            "id": 8802802,
            "automatic": true,
            "trackId": 4882521,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 99,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802803,
            "automatic": true,
            "trackId": 4882521,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866866,
            "automatic": false,
            "trackId": 4882521,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 928,
        "maxFreq": 1292,
        "filtered": false,
        "positions": [
          {
            "x": 0.06,
            "y": 0.03866666666666667,
            "width": 0.01,
            "height": 0.015166666666666667
          }
        ]
      },
      {
        "id": 4882522,
        "start": 7.6467125000000005,
        "end": 8.540058333333333,
        "tags": [
          {
            "confidence": 89,
            "data": {
              "name": "Master"
            },
            "id": 8802804,
            "automatic": true,
            "trackId": 4882522,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 89,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802805,
            "automatic": true,
            "trackId": 4882522,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866867,
            "automatic": false,
            "trackId": 4882522,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 942,
        "maxFreq": 1348,
        "filtered": false,
        "positions": [
          {
            "x": 0.13,
            "y": 0.03925,
            "width": 0.01,
            "height": 0.016916666666666667
          }
        ]
      },
      {
        "id": 4882525,
        "start": 11.389866666666666,
        "end": 12.266820833333334,
        "tags": [
          {
            "confidence": 71,
            "data": {
              "name": "Master"
            },
            "id": 8802806,
            "automatic": true,
            "trackId": 4882525,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 71,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802807,
            "automatic": true,
            "trackId": 4882525,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866869,
            "automatic": false,
            "trackId": 4882525,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 938,
        "maxFreq": 1302,
        "filtered": false,
        "positions": [
          {
            "x": 0.19,
            "y": 0.03908333333333333,
            "width": 0.01,
            "height": 0.015166666666666667
          }
        ]
      },
      {
        "id": 4882527,
        "start": 15.087358333333333,
        "end": 15.898745833333333,
        "tags": [
          {
            "confidence": 65,
            "data": {
              "name": "Master",
              "raw_tag": "bird"
            },
            "id": 8802810,
            "automatic": true,
            "trackId": 4882527,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 65,
            "data": {
              "name": "badv2-april",
              "raw_tag": "bird"
            },
            "id": 8802811,
            "automatic": true,
            "trackId": 4882527,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866868,
            "automatic": false,
            "trackId": 4882527,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 932,
        "maxFreq": 1338,
        "filtered": false,
        "positions": [
          {
            "x": 0.25,
            "y": 0.03883333333333333,
            "width": 0.01,
            "height": 0.016916666666666667
          }
        ]
      },
      {
        "id": 4882529,
        "start": 18.57292916666667,
        "end": 19.408904166666666,
        "tags": [
          {
            "confidence": 30,
            "data": {
              "name": "Master",
              "raw_tag": "bird"
            },
            "id": 8802814,
            "automatic": true,
            "trackId": 4882529,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 30,
            "data": {
              "name": "badv2-april",
              "raw_tag": "bird"
            },
            "id": 8802815,
            "automatic": true,
            "trackId": 4882529,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866870,
            "automatic": false,
            "trackId": 4882529,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 936,
        "maxFreq": 1314,
        "filtered": false,
        "positions": [
          {
            "x": 0.31,
            "y": 0.039,
            "width": 0.01,
            "height": 0.01575
          }
        ]
      },
      {
        "id": 4882531,
        "start": 21.912145833333334,
        "end": 22.731729166666668,
        "tags": [
          {
            "confidence": 80,
            "data": {
              "name": "Master"
            },
            "id": 8802818,
            "automatic": true,
            "trackId": 4882531,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 80,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802819,
            "automatic": true,
            "trackId": 4882531,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866871,
            "automatic": false,
            "trackId": 4882531,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 888,
        "maxFreq": 1322,
        "filtered": false,
        "positions": [
          {
            "x": 0.37,
            "y": 0.037,
            "width": 0.01,
            "height": 0.018083333333333333
          }
        ]
      },
      {
        "id": 4882534,
        "start": 25.601441666666666,
        "end": 26.41282916666667,
        "tags": [
          {
            "confidence": 90,
            "data": {
              "name": "Master"
            },
            "id": 8802822,
            "automatic": true,
            "trackId": 4882534,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 90,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802823,
            "automatic": true,
            "trackId": 4882534,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 95,
            "data": {
              "name": "Master"
            },
            "id": 8802824,
            "automatic": true,
            "trackId": 4882534,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 95,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802826,
            "automatic": true,
            "trackId": 4882534,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866872,
            "automatic": false,
            "trackId": 4882534,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 890,
        "maxFreq": 1310,
        "filtered": false,
        "positions": [
          {
            "x": 0.43,
            "y": 0.037083333333333336,
            "width": 0.01,
            "height": 0.0175
          }
        ]
      },
      {
        "id": 4882536,
        "start": 29.163116666666667,
        "end": 29.958112500000002,
        "tags": [
          {
            "confidence": 79,
            "data": {
              "name": "Master"
            },
            "id": 8802828,
            "automatic": true,
            "trackId": 4882536,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 79,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802830,
            "automatic": true,
            "trackId": 4882536,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 75,
            "data": {
              "name": "Master"
            },
            "id": 8802832,
            "automatic": true,
            "trackId": 4882536,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 75,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802834,
            "automatic": true,
            "trackId": 4882536,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866873,
            "automatic": false,
            "trackId": 4882536,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 934,
        "maxFreq": 1326,
        "filtered": false,
        "positions": [
          {
            "x": 0.49,
            "y": 0.03891666666666667,
            "width": 0.01,
            "height": 0.01633333333333333
          }
        ]
      },
      {
        "id": 4882538,
        "start": 32.65688333333333,
        "end": 33.460075,
        "tags": [
          {
            "confidence": 79,
            "data": {
              "name": "Master"
            },
            "id": 8802836,
            "automatic": true,
            "trackId": 4882538,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 79,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802838,
            "automatic": true,
            "trackId": 4882538,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866874,
            "automatic": false,
            "trackId": 4882538,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 938,
        "maxFreq": 1302,
        "filtered": false,
        "positions": [
          {
            "x": 0.54,
            "y": 0.03908333333333333,
            "width": 0.01,
            "height": 0.015166666666666667
          }
        ]
      },
      {
        "id": 4882540,
        "start": 35.311162499999995,
        "end": 36.056983333333335,
        "tags": [
          {
            "confidence": 59,
            "data": {
              "name": "Master",
              "raw_tag": "bird"
            },
            "id": 8802840,
            "automatic": true,
            "trackId": 4882540,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 59,
            "data": {
              "name": "badv2-april",
              "raw_tag": "bird"
            },
            "id": 8802843,
            "automatic": true,
            "trackId": 4882540,
            "what": "unidentified",
            "path": "all.other.unidentified"
          }
        ],
        "automatic": true,
        "minFreq": 1406,
        "maxFreq": 1854,
        "filtered": false,
        "positions": [
          {
            "x": 0.59,
            "y": 0.058583333333333334,
            "width": 0.01,
            "height": 0.018666666666666668
          }
        ]
      },
      {
        "id": 4882542,
        "start": 36.37779166666667,
        "end": 37.197375,
        "tags": [
          {
            "confidence": 87,
            "data": {
              "name": "Master"
            },
            "id": 8802844,
            "automatic": true,
            "trackId": 4882542,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 87,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802846,
            "automatic": true,
            "trackId": 4882542,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866875,
            "automatic": false,
            "trackId": 4882542,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 914,
        "maxFreq": 1306,
        "filtered": false,
        "positions": [
          {
            "x": 0.61,
            "y": 0.03808333333333333,
            "width": 0.01,
            "height": 0.01633333333333333
          }
        ]
      },
      {
        "id": 4882544,
        "start": 39.969908333333336,
        "end": 40.8468625,
        "tags": [
          {
            "confidence": 91,
            "data": {
              "name": "Master"
            },
            "id": 8802848,
            "automatic": true,
            "trackId": 4882544,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 91,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802850,
            "automatic": true,
            "trackId": 4882544,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 99,
            "data": {
              "name": "Master"
            },
            "id": 8802852,
            "automatic": true,
            "trackId": 4882544,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 99,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802853,
            "automatic": true,
            "trackId": 4882544,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866876,
            "automatic": false,
            "trackId": 4882544,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 926,
        "maxFreq": 1304,
        "filtered": false,
        "positions": [
          {
            "x": 0.67,
            "y": 0.03858333333333333,
            "width": 0.01,
            "height": 0.01575
          }
        ]
      },
      {
        "id": 4882546,
        "start": 43.9729875,
        "end": 44.8581375,
        "tags": [
          {
            "confidence": 93,
            "data": {
              "name": "Master"
            },
            "id": 8802854,
            "automatic": true,
            "trackId": 4882546,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 93,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802855,
            "automatic": true,
            "trackId": 4882546,
            "what": "bellbird",
            "path": "all.bird.bellbird"
          },
          {
            "confidence": 97,
            "data": {
              "name": "Master"
            },
            "id": 8802856,
            "automatic": true,
            "trackId": 4882546,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 97,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802857,
            "automatic": true,
            "trackId": 4882546,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866877,
            "automatic": false,
            "trackId": 4882546,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 890,
        "maxFreq": 1310,
        "filtered": false,
        "positions": [
          {
            "x": 0.73,
            "y": 0.037083333333333336,
            "width": 0.01,
            "height": 0.0175
          }
        ]
      },
      {
        "id": 4882547,
        "start": 47.877716666666664,
        "end": 48.63992916666667,
        "tags": [
          {
            "confidence": 97,
            "data": {
              "name": "Master"
            },
            "id": 8802858,
            "automatic": true,
            "trackId": 4882547,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 97,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802859,
            "automatic": true,
            "trackId": 4882547,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866878,
            "automatic": false,
            "trackId": 4882547,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 950,
        "maxFreq": 1300,
        "filtered": false,
        "positions": [
          {
            "x": 0.8,
            "y": 0.03958333333333333,
            "width": 0.01,
            "height": 0.014583333333333334
          }
        ]
      },
      {
        "id": 4882548,
        "start": 51.7566875,
        "end": 52.57627083333333,
        "tags": [
          {
            "confidence": 92,
            "data": {
              "name": "Master"
            },
            "id": 8802860,
            "automatic": true,
            "trackId": 4882548,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 92,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802861,
            "automatic": true,
            "trackId": 4882548,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866879,
            "automatic": false,
            "trackId": 4882548,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 936,
        "maxFreq": 1314,
        "filtered": false,
        "positions": [
          {
            "x": 0.86,
            "y": 0.039,
            "width": 0.01,
            "height": 0.01575
          }
        ]
      },
      {
        "id": 4882549,
        "start": 55.5080375,
        "end": 56.335816666666666,
        "tags": [
          {
            "confidence": 67,
            "data": {
              "name": "Master",
              "raw_tag": "bird"
            },
            "id": 8802862,
            "automatic": true,
            "trackId": 4882549,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 67,
            "data": {
              "name": "badv2-april",
              "raw_tag": "bird"
            },
            "id": 8802863,
            "automatic": true,
            "trackId": 4882549,
            "what": "unidentified",
            "path": "all.other.unidentified"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866880,
            "automatic": false,
            "trackId": 4882549,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 912,
        "maxFreq": 1318,
        "filtered": false,
        "positions": [
          {
            "x": 0.93,
            "y": 0.038,
            "width": 0.01,
            "height": 0.016916666666666667
          }
        ]
      },
      {
        "id": 4882550,
        "start": 59.23362916666667,
        "end": 60.032,
        "tags": [
          {
            "confidence": 86,
            "data": {
              "name": "Master"
            },
            "id": 8802864,
            "automatic": true,
            "trackId": 4882550,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 86,
            "data": {
              "name": "badv2-april"
            },
            "id": 8802865,
            "automatic": true,
            "trackId": 4882550,
            "what": "bird",
            "path": "all.bird"
          },
          {
            "confidence": 1,
            "data": {},
            "id": 8866881,
            "automatic": false,
            "trackId": 4882550,
            "what": "owl",
            "path": "all.bird.owl",
            "userId": 88,
            "userName": "Shaun Ryan"
          }
        ],
        "automatic": true,
        "minFreq": 948,
        "maxFreq": 1312,
        "filtered": false,
        "positions": [
          {
            "x": 0.99,
            "y": 0.0395,
            "width": 0.01,
            "height": 0.015166666666666667
          }
        ]
      }
    ];
    tracks = tracks.filter(track => !track.filtered);
    tracks = [];
    // TODO: Display recordingDateTime over spectrogram if available.
    // Use metadata reader to pull out recordingDateTime etc, or just have it supplied by the data?
    // Display elapsed time in recording on spectrogram
    // Volume control + amplification and low+high-pass (and mute?  Why would you want to mute?)
    // Filter out stuff below 1Khz
    // Ask about sad state of tracking
    // Ability to create tracks/draw track boxes (drag box, but also just paint a blob?)
    // Overlay frequency bands when the use hovers the spectrogram.
    // Zoom vertically around certain frequencies/ either where cursor is, or to zoom selected boxes.
    // Select a track, and start playing.
    // Draw label for selected track.
    // Bottom playhead to scrub playback globally.
    // Display beginning and end time offsets of selected range?
    // Look at snapping precision issues when zoomed right in?
    // A good way with dealing with the same song at different harmonic offsets?
    // Selecting a box should try to normalise the view to the selected region.

    // spectastiq.renderOverlays = (ctx, startZeroOne, endZeroOne) => {
    //   // All the info we need to render the overlays.
    //
    //   for (let i = 0; i < 24; i++) {
    //     ctx.save();
    //     ctx.beginPath()
    //     // TODO: Maybe just scale by pxRatio here.
    //     ctx.strokeStyle = 'rgba(1, 0, 0, 0.1)';
    //     ctx.lineWidth = 1;
    //     // TODO: Colours, (Plus same outline scheme as cptv-player)
    //     // TODO: Labels
    //     // TODO: Clickability
    //     const cHeight = ctx.canvas.height;// * window.devicePixelRatio;
    //     const cWidth = ctx.canvas.width;// * window.devicePixelRatio;
    //     // I think the y axis needs flipping.
    //     ctx.strokeRect(0, i * (cHeight / 24), cWidth, 0);
    //     //console.log(range, l, r, l * cWidth, (l + r) * cWidth);
    //     ctx.restore();
    //   }
    //   //console.log("Canvas dims", ctx.canvas.width, ctx.canvas.height);
    //   for (const track of tracks) {
    //     for (const position of track.positions) {
    //       const left = Math.max(0, position.x);
    //       const right = Math.min(1, left + position.width);
    //       const range = endZeroOne - startZeroOne;
    //       const top = position.y;
    //       const bottom = position.y - position.height;
    //       const h = top - bottom;
    //       let l = (left - startZeroOne) / range;
    //       let r = (right - startZeroOne) / range;
    //       ctx.save();
    //       ctx.beginPath()
    //       // TODO: Maybe just scale by pxRatio here.
    //       ctx.strokeStyle = "red";
    //       ctx.lineWidth = 1.5;
    //       // TODO: Colours, (Plus same outline scheme as cptv-player)
    //       // TODO: Labels
    //       // TODO: Clickability
    //       const cHeight = ctx.canvas.height;
    //       const cWidth = ctx.canvas.width;
    //       // NOTE: Y-axis is flipped
    //       ctx.strokeRect(l * cWidth, (1 - top - h) * cHeight, (r - l) * cWidth, cHeight * h);
    //       ctx.restore();
    //     }
    //     //}
    //   }
    //   // for (const track of tracks) {
    //   //   for (const position of track.positions) {
    //   //     const left = Math.max(0, position.x);
    //   //     const right = Math.min(1, left + position.width);
    //   //     //if ((left >= startZeroOne && left <= endZeroOne) || (right >= startZeroOne && right <= endZeroOne)) {
    //   //     // Map left and right into range.
    //   //     const range = e - s;
    //   //
    //   //
    //   //     // The track data is created on a log scale, we're using linear, so use the minFreq/maxFreq instead.
    //   //     // Or maybe I'm the one using a weird scale?
    //   //     // const top = track.maxFreq / 24000;
    //   //     // const bottom = track.minFreq / 24000;
    //   //     const top = track.minFreq / 24000;
    //   //     const bottom = track.maxFreq / 24000;
    //   //     // const top = position.y;
    //   //     // const bottom = position.y - position.height;
    //   //     const h = bottom - top;
    //   //     //console.log("t/b", top, bottom, h, position.y, position.height);
    //   //
    //   //     // If range is from 0.2 to 0.4 and position is at 0.3, it should be in the middle.
    //   //     // 0.3 - 0.2 (0.1)
    //   //
    //   //     let l = (left - s) / range;
    //   //     let r = (right - s) / range;
    //   //
    //   //     ctx.save();
    //   //     ctx.beginPath()
    //   //     // TODO: Maybe just scale by pxRatio here.
    //   //     ctx.strokeStyle = "blue";
    //   //     ctx.lineWidth = 1;
    //   //     // TODO: Colours, (Plus same outline scheme as cptv-player)
    //   //     // TODO: Labels
    //   //     // TODO: Clickability
    //   //     const cHeight = ctx.canvas.height;// * window.devicePixelRatio;
    //   //     const cWidth = ctx.canvas.width;// * window.devicePixelRatio;
    //   //     // I think the y axis needs flipping.
    //   //     const flip = true;
    //   //     if (flip) {
    //   //       ctx.strokeRect(l * cWidth, (1 - top - h) * cHeight, (r - l) * cWidth, cHeight * h);
    //   //     } else {
    //   //       ctx.strokeRect(l * cWidth, (top - h) * cHeight, (r - l) * cWidth, cHeight * h);
    //   //     }
    //   //     //console.log(range, l, r, l * cWidth, (l + r) * cWidth);
    //   //     ctx.restore();
    //   //   }
    //   //   //}
    //   // }
    //   // for (const track of tracks) {
    //   //   for (const position of track.positions) {
    //   //     const left = Math.max(0, position.x);
    //   //     const right = Math.min(1, left + position.width);
    //   //     //if ((left >= startZeroOne && left <= endZeroOne) || (right >= startZeroOne && right <= endZeroOne)) {
    //   //     // Map left and right into range.
    //   //     const range = e - s;
    //   //
    //   //
    //   //     // The track data is created on a log scale, we're using linear, so use the minFreq/maxFreq instead.
    //   //     // Or maybe I'm the one using a weird scale?
    //   //     // const top = track.maxFreq / 24000;
    //   //     // const bottom = track.minFreq / 24000;
    //   //     const hh = ctx.canvas.height / 24000;
    //   //     console.log(track.minFreq, track.maxFreq);
    //   //     const top = (track.minFreq || 0) * hh;
    //   //     const bottom = track.maxFreq * hh;
    //   //     // const top = position.y;
    //   //     // const bottom = position.y - position.height;
    //   //     const h = bottom - top;
    //   //     //console.log("t/b", top, bottom, h, position.y, position.height);
    //   //
    //   //     // If range is from 0.2 to 0.4 and position is at 0.3, it should be in the middle.
    //   //     // 0.3 - 0.2 (0.1)
    //   //
    //   //     let l = (left - s) / range;
    //   //     let r = (right - s) / range;
    //   //
    //   //     ctx.save();
    //   //     ctx.beginPath()
    //   //     // TODO: Maybe just scale by pxRatio here.
    //   //     ctx.strokeStyle = "blue";
    //   //     ctx.lineWidth = 1;
    //   //     // TODO: Colours, (Plus same outline scheme as cptv-player)
    //   //     // TODO: Labels
    //   //     // TODO: Clickability
    //   //     const cHeight = ctx.canvas.height;// * window.devicePixelRatio;
    //   //     const cWidth = ctx.canvas.width;// * window.devicePixelRatio;
    //   //     // I think the y axis needs flipping.
    //   //     const flip = false;
    //   //     if (flip) {
    //   //       ctx.strokeRect(l * cWidth, (1 - top - h) * cHeight, (r - l) * cWidth, cHeight * h);
    //   //     } else {
    //   //       console.log("strokeRect", l * cWidth, cHeight-top, (r - l) * cWidth, top - bottom)
    //   //       ctx.strokeRect(l * cWidth, cHeight-top, (r - l) * cWidth, top - bottom);
    //   //     }
    //   //     //console.log(range, l, r, l * cWidth, (l + r) * cWidth);
    //   //     ctx.restore();
    //   //   }
    //   //   //}
    //   // }
    //
    // };
    // spectastiq.onRegionCreated = (dimensions) => {
    //   // Should update tracks.
    // }
    // spectastiq.onClickSpectrogram = (ctx, xOffset, yOffset, startZeroOne, endZeroOne) => {
    //   // Tells us where in the spectrogram was clicked.
    // };

    // Handle interactions on the spectrogram component.
    // spectastiq.onPointerDownOn = (ctx, xOffset, yOffset, startZeroOne, endZeroOne) => {
    //   // Tells us where in the spectrogram was clicked.
    // };
    // spectastiq.onPointerUp = (ctx, xOffset, yOffset, startZeroOne, endZeroOne) => {
    //   // Tells us where in the spectrogram was clicked.
    // };
    // spectastiq.onPointerMove = (ctx, xOffset, yOffset, startZeroOne, endZeroOne) => {
    //   // Tells us where in the spectrogram was clicked.
    // };
    spectastiq.addEventListener("spectrogram-pointer-move", ({detail: { range: {begin, end }, surface: ctx, main }}) => {

    });
    spectastiq.addEventListener("spectrogram-pointer-down", ({detail: { range: {begin, end }, surface: ctx, main }}) => {

    });
    spectastiq.addEventListener("spectrogram-pointer-up", ({detail: { range: {begin, end }, surface: ctx, main }}) => {

    });
    // spectastiq.selectRegion(rect);
    // spectastiq.clearSelection();
    // https://browse.cacophony.org.nz/recording/1949132?tagMode=any&group=207

    spectastiq.addEventListener("render", ({ detail: { range: { begin, end }, surface: ctx, main } }) => {
      if (main) {
        ctx.save();
        for (let i = 0; i < 24; i++) {
          ctx.beginPath()
          ctx.strokeStyle = 'rgba(1, 0, 0, 0.1)';
          ctx.lineWidth = 1;
          const cHeight = ctx.canvas.height;
          const cWidth = ctx.canvas.width;
          ctx.strokeRect(0, i * (cHeight / 24), cWidth, 0);
        }
        for (const track of tracks) {
          for (const position of track.positions) {
            const left = Math.max(0, position.x);
            const right = Math.min(1, left + position.width);
            const range = end - begin;
            const top = position.y;
            const bottom = position.y - position.height;
            const h = top - bottom;
            let l = (left - begin) / range;
            let r = (right - begin) / range;
            ctx.beginPath();
            ctx.strokeStyle = "red";
            ctx.lineWidth = 1.5;
            const cHeight = ctx.canvas.height;
            const cWidth = ctx.canvas.width;
            // NOTE: Y-axis is flipped
            ctx.strokeRect(l * cWidth, (1 - top - h) * cHeight, (r - l) * cWidth, cHeight * h);
          }
          ctx.restore();
        }
      }
    });


    const buttons =  document.querySelectorAll('.src-button');
    buttons.forEach(button => {
      button.addEventListener('click', (e) => {
        spectastiq.setAttribute("src", e.target.innerText.trim());
      });
    });
  </script>
</body>
</html>
